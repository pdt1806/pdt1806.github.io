import{r as S}from"./react-7b818ef1.js";import{P as D}from"./prop-types-8d262492.js";import{h as P}from"./hoist-non-react-statics-6cec555a.js";function O(){return O=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var p=arguments[t];for(var a in p)Object.prototype.hasOwnProperty.call(p,a)&&(n[a]=p[a])}return n},O.apply(this,arguments)}function T(n,t){if(n==null)return{};var p={},a=Object.keys(n),v,l;for(l=0;l<a.length;l++)v=a[l],!(t.indexOf(v)>=0)&&(p[v]=n[v]);return p}function j(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.__proto__=t}var c={},k=0;function F(n,t){return t=t||{},function(a){var v=a.displayName||a.name||"Component",l=function(h){j(m,h);function m(s,e){var r;return r=h.call(this,s,e)||this,r.state={},r.__scriptURL="",r}var f=m.prototype;return f.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+k++),this.__scriptLoaderID},f.setupScriptURL=function(){return this.__scriptURL=typeof n=="function"?n():n,this.__scriptURL},f.asyncScriptLoaderHandleLoad=function(e){var r=this;this.setState(e,function(){return r.props.asyncScriptOnLoad&&r.props.asyncScriptOnLoad(r.state)})},f.asyncScriptLoaderTriggerOnScriptLoaded=function(){var e=c[this.__scriptURL];if(!e||!e.loaded)throw new Error("Script is not loaded.");for(var r in e.observers)e.observers[r](e);delete window[t.callbackName]},f.componentDidMount=function(){var e=this,r=this.setupScriptURL(),i=this.asyncScriptLoaderGetScriptLoaderID(),d=t,g=d.globalName,w=d.callbackName,R=d.scriptId;if(g&&typeof window[g]<"u"&&(c[r]={loaded:!0,observers:{}}),c[r]){var L=c[r];if(L&&(L.loaded||L.errored)){this.asyncScriptLoaderHandleLoad(L);return}L.observers[i]=function(o){return e.asyncScriptLoaderHandleLoad(o)};return}var N={};N[i]=function(o){return e.asyncScriptLoaderHandleLoad(o)},c[r]={loaded:!1,observers:N};var u=document.createElement("script");u.src=r,u.async=!0;for(var U in t.attributes)u.setAttribute(U,t.attributes[U]);R&&(u.id=R);var E=function(y){if(c[r]){var A=c[r],b=A.observers;for(var I in b)y(b[I])&&delete b[I]}};w&&typeof window<"u"&&(window[w]=function(){return e.asyncScriptLoaderTriggerOnScriptLoaded()}),u.onload=function(){var o=c[r];o&&(o.loaded=!0,E(function(y){return w?!1:(y(o),!0)}))},u.onerror=function(){var o=c[r];o&&(o.errored=!0,E(function(y){return y(o),!0}))},document.body.appendChild(u)},f.componentWillUnmount=function(){var e=this.__scriptURL;if(t.removeOnUnmount===!0)for(var r=document.getElementsByTagName("script"),i=0;i<r.length;i+=1)r[i].src.indexOf(e)>-1&&r[i].parentNode&&r[i].parentNode.removeChild(r[i]);var d=c[e];d&&(delete d.observers[this.asyncScriptLoaderGetScriptLoaderID()],t.removeOnUnmount===!0&&delete c[e])},f.render=function(){var e=t.globalName,r=this.props;r.asyncScriptOnLoad;var i=r.forwardedRef,d=T(r,["asyncScriptOnLoad","forwardedRef"]);return e&&typeof window<"u"&&(d[e]=typeof window[e]<"u"?window[e]:void 0),d.ref=i,S.createElement(a,d)},m}(S.Component),_=S.forwardRef(function(h,m){return S.createElement(l,O({},h,{forwardedRef:m}))});return _.displayName="AsyncScriptLoader("+v+")",_.propTypes={asyncScriptOnLoad:D.func},P(_,a)}}export{F as m};
